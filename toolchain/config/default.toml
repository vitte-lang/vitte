# toolchain/config/default.toml
#
# Vitte toolchain â€“ default configuration entrypoint.
#
# Composition model:
#  - This file defines baseline defaults and references other canonical configs.
#  - Target presets in toolchain/config/targets/*.toml override these defaults.
#  - Project/user profiles override both.
#
# Loader expectations (suggested):
#  - Load this file first
#  - Merge includes in order
#  - Merge target preset
#  - Merge user/project overrides
#
# If your config loader does not support "include", treat this as documentation
# and flatten in the loader.

[version]
schema = 1

[include]
files = [
  "c_std.toml",
  "cpp_std.toml",
]

[defaults]
# Default selected target preset if the user does not specify one.
target = "host"     # "host" or a filename stem in config/targets/

# Default output directories (relative to workspace/build root).
out_dir      = "build"
obj_dir      = "build/obj"
bin_dir      = "build/bin"
lib_dir      = "build/lib"
cache_dir    = "build/.cache"
rsp_dir      = "build/.rsp"

# Toolchain probing behavior.
probe_via_which        = true
use_clang_dumpmachine  = true

# Default toolchain env keys (documentary; actual reading is in clang_env.c)
env = [
  "VITTE_LLVM_BIN",
  "VITTE_TOOLCHAIN_ROOT",
  "VITTE_CLANG",
  "VITTE_CLANGXX",
  "VITTE_LLD",
  "VITTE_LLVM_AR",
  "VITTE_LLVM_RANLIB",
]

[toolchain]
# Empty means: resolved by clang_env + probing + PATH.
clang       = ""
clangxx     = ""
lld         = ""
llvm_ar     = ""
llvm_ranlib = ""

[sdk]
# Default SDK behavior; overridden by target presets.
kind      = "auto"   # auto|none|macos|ios|ios_sim|android|windows
sysroot   = ""
use_xcrun = true

[compile]
# Defaults; target preset may override.
lang_std_c   = "c17"
lang_std_cxx = "c++20"

# Baseline compilation mode.
opt   = "O2"
debug = "g0"

# Codegen policies.
pic = true
lto = false

# Diagnostics.
color_diagnostics = true

# Warning policy keyword.
warnings = "default"

# Response files.
force_rsp   = false
disable_rsp = false

# Global compile defines/includes (additional to c_std/cpp_std).
defines = [
  "VITTE_BUILD=1",
]
include_dirs = [
  "toolchain/config/include",
]

[link]
use_lld = true
pie     = true

# Extra raw args appended to link command.
args = [
]

[libraries]
lib_dirs = [
]
libs = [
]

[archive]
# llvm-ar/ranlib policy
deterministic = true
run_ranlib    = false

[targets]
# Known built-in target preset names (for UX/completions); optional.
known = [
  "darwin_arm64",
  "darwin_x86_64",
  "freebsd_x86_64",
  "linux_aarch64",
  "linux_x86_64",
  "windows_x86_64_gnu",
  "windows_x86_64_msvc",
]
