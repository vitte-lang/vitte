# toolchain/config/lto.toml
#
# Vitte toolchain â€“ Link Time Optimization (LTO) profile.
#
# Merge this profile on top of default.toml + target preset.
# This profile focuses on performance/size via LTO and related knobs.

[version]
schema = 1

[profile]
name = "lto"

[compile]
# Enable LTO at compile time.
lto = true

# Prefer optimized builds.
opt   = "O3"
debug = "g0"

# Keep warnings reasonable.
warnings = "default"
werror   = false

# Response files often help because LTO/link steps can have long arg lists.
force_rsp = false

# Optional: set thin LTO policy keyword if your loader supports it.
# lto_mode = "thin"   # full|thin

defines = [
  "VITTE_LTO=1",
]

[link]
use_lld = true

# Some platforms benefit from identical code folding / gc-sections when lld is used.
# These are platform-dependent; keep as raw args if needed.
args = [
  # ELF:
  # "-Wl,--gc-sections",
  # "-Wl,--icf=safe",

  # macOS (ld64/lld):
  # "-Wl,-dead_strip",
]

# Optionally strip in LTO profile (commonly used for distribution).
strip = true

[libraries]
lib_dirs = [
]
libs = [
]

[archive]
deterministic = true
run_ranlib    = false
