{"version":3,"file":"projectTree.js","sourceRoot":"","sources":["../../../src/providers/tree/projectTree.ts"],"names":[],"mappings":"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","sourcesContent":["import * as vscode from 'vscode';\nimport * as path from 'path';\n\n// Compat: VS Code versions without Uri.joinPath\nfunction joinPathCompat(base: vscode.Uri, ...parts: string[]): vscode.Uri {\n  const anyUri = vscode.Uri as unknown as { joinPath?: (base: vscode.Uri, ...pathSegments: string[]) => vscode.Uri };\n  if (typeof anyUri.joinPath === 'function') {\n    return anyUri.joinPath(base, ...parts);\n  }\n  return vscode.Uri.file(path.join(base.fsPath, ...parts));\n}\n\n// ---- Types ----\ninterface NodeBase { id: string; label: string; contextValue: string; collapsible: vscode.TreeItemCollapsibleState }\ninterface FileNode extends NodeBase { kind: 'file'; uri: vscode.Uri }\ninterface DirNode extends NodeBase { kind: 'dir'; uri: vscode.Uri }\ninterface GroupNode extends NodeBase { kind: 'group'; icon?: string; children: Node[] }\ninterface TargetNode extends NodeBase { kind: 'target'; triple: string; icon?: string }\nexport type Node = FileNode | DirNode | GroupNode | TargetNode;\n\n// ---- Utils ----\nfunction readWorkspaceRoot(): vscode.Uri | undefined {\n  return vscode.workspace.workspaceFolders?.[0]?.uri;\n}\n\nasync function findOne(glob: string): Promise<vscode.Uri | undefined> {\n  const list = await vscode.workspace.findFiles(glob, '**/node_modules/**', 1);\n  return list[0];\n}\n\nasync function findMany(glob: string, limit = 50): Promise<vscode.Uri[]> {\n  return vscode.workspace.findFiles(glob, '**/node_modules/**', limit);\n}\n\nfunction mkId(...parts: string[]): string { return parts.join(':'); }\n\nfunction mkFile(uri: vscode.Uri, label?: string): FileNode {\n  return { id: mkId('file', uri.fsPath), label: label ?? path.basename(uri.fsPath), contextValue: 'vitte:file', kind: 'file', uri, collapsible: vscode.TreeItemCollapsibleState.None };\n}\n\nfunction mkDir(uri: vscode.Uri, label?: string): DirNode {\n  return { id: mkId('dir', uri.fsPath), label: label ?? path.basename(uri.fsPath), contextValue: 'vitte:dir', kind: 'dir', uri, collapsible: vscode.TreeItemCollapsibleState.Collapsed };\n}\n\nfunction mkGroup(id: string, label: string, icon?: string, children: Node[] = []): GroupNode {\n  const group: GroupNode = {\n    id,\n    label,\n    contextValue: 'vitte:group',\n    kind: 'group',\n    collapsible: vscode.TreeItemCollapsibleState.Collapsed,\n    children,\n  };\n  if (icon !== undefined) {\n    group.icon = icon;\n  }\n  return group;\n}\n\nfunction mkTarget(triple: string): TargetNode {\n  return {\n    id: mkId('target', triple),\n    label: triple,\n    contextValue: 'vitte:target',\n    kind: 'target',\n    collapsible: vscode.TreeItemCollapsibleState.None,\n    triple,\n    icon: 'rocket',\n  };\n}\n\n// ---- Provider ----\nexport class VitteProjectTreeProvider implements vscode.TreeDataProvider<Node> {\n  private iconAsset(name: string) {\n    // Use the same SVG for light/dark; you can add themed variants later if needed.\n    const p = (n: string) => vscode.Uri.file(path.join(this.ctx.extensionUri.fsPath, 'media', 'icons', `${n}.svg`));\n    const u = p(name);\n    return { light: u, dark: u } as { light: vscode.Uri; dark: vscode.Uri };\n  }\n\nprivate _onDidChangeTreeData = new vscode.EventEmitter<Node | null | undefined>();\nreadonly onDidChangeTreeData: vscode.Event<Node | null | undefined> = this._onDidChangeTreeData.event;\n\n  constructor(private readonly ctx: vscode.ExtensionContext) {}\n\n  refresh(): void { this._onDidChangeTreeData.fire(undefined); }\n\n  getTreeItem(element: Node): vscode.TreeItem {\n    const item = new vscode.TreeItem(element.label, element.collapsible);\n    item.contextValue = element.contextValue;\n\n    switch (element.kind) {\n      case 'file':\n        item.resourceUri = element.uri;\n        item.command = { command: 'vscode.open', title: 'Open', arguments: [element.uri] };\n        item.iconPath = vscode.ThemeIcon.File;\n        break;\n      case 'dir':\n        item.resourceUri = element.uri;\n        item.iconPath = vscode.ThemeIcon.Folder;\n        break;\n      case 'group':\n        // Use packaged SVG (media/icons/vitte.svg or other). Fallback to 'vitte'.\n        item.iconPath = this.iconAsset(element.icon ?? 'vitte');\n        break;\n      case 'target':\n        item.iconPath = this.iconAsset(element.icon ?? 'vitte');\n        break;\n    }\n    return item;\n  }\n\n  async getChildren(element?: Node): Promise<Node[]> {\n    if (!element) return await this.buildRoot();\n    if (element.kind === 'group') return element.children;\n    if (element.kind === 'dir') return await this.readDirChildren(element.uri);\n    return [];\n  }\n\n  // ---- Builders ----\n  private async buildRoot(): Promise<Node[]> {\n    const root = readWorkspaceRoot();\n    if (!root) return [];\n\n    const nodes: Node[] = [];\n\n    // Config group\n    const vitteConfig = (await findOne('vitte.config.json')) ?? (await findOne('.vitte/config.json'));\n    const configGroup = mkGroup('group:config', 'Configuration', 'settings');\n    if (vitteConfig) configGroup.children.push(mkFile(vitteConfig, 'vitte.config.json'));\n    const tasksJson = await findOne('.vscode/tasks.json');\n    if (tasksJson) configGroup.children.push(mkFile(tasksJson));\n    const launchJson = await findOne('.vscode/launch.json');\n    if (launchJson) configGroup.children.push(mkFile(launchJson));\n    nodes.push(configGroup);\n\n    // Targets group from config if present\n    const targets = await this.readTargetsFromConfig(vitteConfig);\n    const targetGroup = mkGroup('group:targets', 'Cibles', 'rocket');\n    for (const t of targets) targetGroup.children.push(mkTarget(t));\n    nodes.push(targetGroup);\n\n    // Sources group\n    const srcGroup = mkGroup('group:sources', 'Sources', 'source-control');\n    const modulesDirs = await findMany('{src,modules,crates}/**/*.vitte', 200);\n    // Group by folder\n    const byDir = new Map<string, vscode.Uri[]>();\n    for (const uri of modulesDirs) {\n      const dir = path.dirname(uri.fsPath);\n      const arr = byDir.get(dir) ?? [];\n      arr.push(uri);\n      byDir.set(dir, arr);\n    }\n    for (const [dir, files] of byDir) {\n      const children = files.map(f => mkFile(f));\n      const label = path.basename(dir);\n      const dirGroup = mkGroup(`group:src:${dir}`, label, 'source-control', children);\n      srcGroup.children.push(dirGroup);\n    }\n    nodes.push(srcGroup);\n\n    // Tests group\n    const tests = await findMany('**/*_test.vitte', 200);\n    const testGroup = mkGroup('group:tests', `Tests (${tests.length})`, 'beaker');\n    for (const t of tests) testGroup.children.push(mkFile(t));\n    nodes.push(testGroup);\n\n    // Benchmarks group\n    const benches = await findMany('**/*_bench.vitte', 200);\n    const benchGroup = mkGroup('group:bench', `Benchmarks (${benches.length})`, 'graph');\n    for (const b of benches) benchGroup.children.push(mkFile(b));\n    nodes.push(benchGroup);\n\n    return nodes;\n  }\n\n  private async readDirChildren(dir: vscode.Uri): Promise<Node[]> {\n    try {\n      const entries = await vscode.workspace.fs.readDirectory(dir);\n      const nodes: Node[] = [];\n      for (const [name, type] of entries) {\n        const uri = joinPathCompat(dir, name);\n        if (type === vscode.FileType.File && /\\.(vitte|vit)$/i.test(name)) nodes.push(mkFile(uri));\n        if (type === vscode.FileType.Directory) nodes.push(mkDir(uri));\n      }\n      return nodes;\n    } catch {\n      return [];\n    }\n  }\n\n  private async readTargetsFromConfig(configUri?: vscode.Uri): Promise<string[]> {\n    if (!configUri) return [];\n    try {\n      const doc = await vscode.workspace.openTextDocument(configUri);\n      const json = JSON.parse(doc.getText()) as unknown;\n      const rawTargets = (json as { targets?: unknown }).targets;\n      if (Array.isArray(rawTargets)) {\n        const list: string[] = [];\n        for (const entry of rawTargets as unknown[]) {\n          if (typeof entry === 'string') {\n            list.push(entry);\n          } else if (entry && typeof entry === 'object') {\n            const triple = (entry as { triple?: unknown }).triple;\n            if (typeof triple === 'string') list.push(triple);\n          }\n        }\n        return list;\n      }\n    } catch {\n      // ignore\n    }\n    return [];\n  }\n}\n\n// ---- Registration helper ----\nexport function registerProjectTree(ctx: vscode.ExtensionContext): VitteProjectTreeProvider {\n  const provider = new VitteProjectTreeProvider(ctx);\n  ctx.subscriptions.push(\n    vscode.window.registerTreeDataProvider('vitteExplorer', provider),\n    vscode.commands.registerCommand('vitte.refreshExplorer', () => provider.refresh()),\n    vscode.commands.registerCommand('vitte.revealInExplorer', (uri: vscode.Uri) => {\n      void vscode.commands.executeCommand('revealInExplorer', uri);\n    })\n  );\n  return provider;\n}\n"]}