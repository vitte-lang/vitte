{"version":3,"file":"indexer.js","sourceRoot":"","sources":["../../src/indexer.ts"],"names":[],"mappings":"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","sourcesContent":["// indexer.ts — indexation robuste des symboles pour Vitte/Vit (LSP prêt, sans dépendance runtime)\n\n// Import minimal côté serveur LSP.\nimport { TextDocument } from \"vscode-languageserver-textdocument\";\nimport type {\n  DocumentSymbol as LspDocumentSymbol,\n  Location as LspLocation,\n  Position as LspPosition,\n  Range as LspRange,\n  SymbolInformation as LspSymbolInformation,\n  SymbolKind as LspSymbolKind,\n} from \"vscode-languageserver-types\";\n\n/* ============================================================================\n * Types et constantes\n * ========================================================================== */\n\n// Utiliser \"enum\" plutôt que \"const enum\" pour éviter les soucis de transpilation TS dans certains toolchains.\nexport enum SK {\n  Module = 2,\n  Namespace = 3,\n  Class = 5,\n  Method = 6,\n  Property = 7,\n  Field = 8,\n  Constructor = 9,\n  Enum = 10,\n  Interface = 11,\n  Function = 12,\n  Variable = 13,\n  Constant = 14,\n  Struct = 23,\n  TypeParameter = 26,\n}\n\nexport interface IndexedSymbol {\n  name: string;\n  kind: SK;\n  uri: string;\n  line: number;\n  character: number;\n  endLine?: number;\n  endCharacter?: number;\n  containerName?: string;\n}\n\ntype Uri = string;\n\n/** Index global: uri -> liste de symboles */\nconst INDEX = new Map<Uri, IndexedSymbol[]>();\n\ninterface DeclarationInfo {\n  kind: SK;\n  expectBody: boolean;\n  allowBodyless?: boolean;\n}\n\ninterface PendingBody {\n  symbolIndex: number;\n  allowBodyless: boolean;\n  startOffset: number;\n  bodyOffset?: number;\n}\n\ntype BodyExpectation =\n  | { kind: \"body\"; offset: number }\n  | { kind: \"none\" }\n  | { kind: \"unknown\" };\n\nconst DECLARATIONS = new Map<string, DeclarationInfo>([\n  [\"module\", { kind: SK.Namespace, expectBody: true, allowBodyless: true }],\n  [\"struct\", { kind: SK.Struct, expectBody: true }],\n  [\"enum\", { kind: SK.Enum, expectBody: true }],\n  [\"union\", { kind: SK.Struct, expectBody: true }],\n  [\"type\", { kind: SK.Interface, expectBody: false }],\n  [\"fn\", { kind: SK.Function, expectBody: true, allowBodyless: true }],\n  [\"const\", { kind: SK.Constant, expectBody: false }],\n  [\"static\", { kind: SK.Variable, expectBody: false }],\n]);\n\nconst MODIFIERS = new Set([\"pub\"]);\n\nclass SymbolParser {\n  private readonly text: string;\n  private readonly masked: string;\n  private readonly length: number;\n  private readonly symbols: IndexedSymbol[] = [];\n  private readonly braceStack: { symbolIndex: number | null; offset: number }[] = [];\n  private readonly pendingBodies: PendingBody[] = [];\n  private readonly activeSymbols: number[] = [];\n  private pos = 0;\n\n  constructor(private readonly doc: TextDocument) {\n    this.text = doc.getText();\n    this.masked = maskNonCode(this.text);\n    this.length = this.masked.length;\n  }\n\n  parse(): IndexedSymbol[] {\n    while (this.pos < this.length) {\n      const ch = this.masked[this.pos];\n\n      if (isWhitespace(ch)) {\n        this.pos++;\n        continue;\n      }\n\n      if (ch === \"#\") {\n        this.skipAttribute();\n        continue;\n      }\n\n      if (ch === \"{\") {\n        this.handleOpenBrace();\n        this.pos++;\n        continue;\n      }\n\n      if (ch === \"}\") {\n        this.handleCloseBrace();\n        this.pos++;\n        continue;\n      }\n\n      if (ch === \";\") {\n        this.handleSemicolon();\n        this.pos++;\n        continue;\n      }\n\n      if (isIdentifierStart(ch)) {\n        const keywordStart = this.pos;\n        const word = this.readWord();\n        if (!word) {\n          this.pos++;\n          continue;\n        }\n\n        const lower = word.toLowerCase();\n\n        if (MODIFIERS.has(lower)) {\n          this.skipModifierTail(lower);\n          continue;\n        }\n\n        const decl = DECLARATIONS.get(lower);\n        if (decl) {\n          this.handleDeclaration(lower, keywordStart, decl);\n          continue;\n        }\n\n        continue;\n      }\n\n      this.pos++;\n    }\n\n    return this.symbols;\n  }\n\n  private handleDeclaration(keyword: string, startOffset: number, info: DeclarationInfo): void {\n    const name = this.readSymbolName(keyword);\n    if (!name) return;\n\n    const startPos = this.doc.positionAt(startOffset);\n    const sym: IndexedSymbol = {\n      name,\n      kind: info.kind,\n      uri: this.doc.uri,\n      line: startPos.line,\n      character: startPos.character,\n    };\n\n    const container = this.currentContainer();\n    if (container) {\n      sym.containerName = container.name;\n    }\n\n    const index = this.symbols.push(sym) - 1;\n\n    if (info.expectBody) {\n      const expectation = this.probeBodyOffset(info, this.pos);\n      if (expectation.kind === \"body\") {\n        this.pendingBodies.push({\n          symbolIndex: index,\n          allowBodyless: !!info.allowBodyless,\n          startOffset,\n          bodyOffset: expectation.offset,\n        });\n      } else if (expectation.kind === \"unknown\") {\n        this.pendingBodies.push({\n          symbolIndex: index,\n          allowBodyless: !!info.allowBodyless,\n          startOffset,\n        });\n      }\n    }\n  }\n\n  private readSymbolName(keyword: string): string | undefined {\n    switch (keyword) {\n      case \"module\":\n        return this.readQualifiedName();\n      case \"struct\":\n      case \"enum\":\n      case \"union\":\n      case \"type\":\n        this.skipTrivia();\n        return this.readIdentifierToken();\n      case \"fn\":\n        this.skipTrivia();\n        return this.readFunctionName();\n      case \"const\":\n      case \"static\":\n        return this.readConstName();\n      default:\n        return undefined;\n    }\n  }\n\n  private readQualifiedName(): string | undefined {\n    const segments: string[] = [];\n    while (true) {\n      this.skipTrivia();\n      const segment = this.readIdentifierToken();\n      if (!segment) break;\n      segments.push(segment);\n\n      const saved = this.pos;\n      this.skipTrivia();\n      if (this.masked[this.pos] === \":\" && this.masked[this.pos + 1] === \":\") {\n        this.pos += 2;\n        continue;\n      }\n      this.pos = saved;\n      break;\n    }\n    return segments.length ? segments.join(\"::\") : undefined;\n  }\n\n  private readFunctionName(): string | undefined {\n    return this.readIdentifierToken();\n  }\n\n  private readConstName(): string | undefined {\n    this.skipTrivia();\n    return this.readIdentifierToken();\n  }\n\n  private readIdentifierToken(): string | undefined {\n    if (!isIdentifierStart(this.masked[this.pos])) return undefined;\n    const start = this.pos;\n    this.pos++;\n    while (this.pos < this.length && isIdentifierPart(this.masked[this.pos])) {\n      this.pos++;\n    }\n    const raw = this.text.slice(start, this.pos);\n    const trimmed = raw.trim();\n    return trimmed ? trimmed : undefined;\n  }\n\n  private readWord(): string {\n    const start = this.pos;\n    while (this.pos < this.length && isIdentifierPart(this.masked[this.pos])) {\n      this.pos++;\n    }\n    return this.masked.slice(start, this.pos);\n  }\n\n  private skipModifierTail(word: string): void {\n    if (word === \"pub\") {\n      this.skipTrivia();\n      if (this.masked[this.pos] === \"(\") {\n        this.pos = this.skipBalancedFrom(this.pos, \"(\", \")\");\n        this.skipTrivia();\n      }\n    }\n  }\n\n  private skipBalancedFrom(index: number, open: string, close: string): number {\n    let depth = 0;\n    let i = index;\n    while (i < this.length) {\n      const ch = this.masked[i];\n      if (ch === open) depth++;\n      else if (ch === close) {\n        depth--;\n        if (depth === 0) return i + 1;\n      }\n      i++;\n    }\n    return this.length;\n  }\n\n  private skipAttribute(): void {\n    let i = this.pos + 1;\n    if (i < this.length && this.masked[i] === \"!\") {\n      i++;\n    }\n    while (i < this.length && isWhitespace(this.masked[i])) i++;\n    if (i >= this.length || this.masked[i] !== \"[\") {\n      this.pos++;\n      return;\n    }\n    const end = this.skipBalancedFrom(i, \"[\", \"]\");\n    this.pos = Math.max(end, i + 1);\n  }\n\n  private skipTrivia(): void {\n    while (this.pos < this.length && isWhitespace(this.masked[this.pos])) {\n      this.pos++;\n    }\n  }\n\n  private currentContainer(): IndexedSymbol | undefined {\n    if (!this.activeSymbols.length) return undefined;\n    return this.symbols[this.activeSymbols[this.activeSymbols.length - 1]];\n  }\n\n  private handleOpenBrace(): void {\n    const currentOffset = this.pos;\n    let matchedIndex = -1;\n    for (let i = this.pendingBodies.length - 1; i >= 0; i--) {\n      const pending = this.pendingBodies[i];\n      if (pending.bodyOffset !== undefined && pending.bodyOffset !== currentOffset) {\n        continue;\n      }\n      matchedIndex = i;\n      break;\n    }\n\n    let symbolIndex: number | null = null;\n    if (matchedIndex >= 0) {\n      const [pending] = this.pendingBodies.splice(matchedIndex, 1);\n      symbolIndex = pending.symbolIndex;\n      this.activeSymbols.push(symbolIndex);\n    }\n\n    this.braceStack.push({ symbolIndex, offset: currentOffset });\n  }\n\n  private handleCloseBrace(): void {\n    const frame = this.braceStack.pop();\n    if (!frame) return;\n    if (frame.symbolIndex != null) {\n      const pos = this.doc.positionAt(this.pos);\n      const sym = this.symbols[frame.symbolIndex];\n      sym.endLine = pos.line;\n      sym.endCharacter = pos.character + 1;\n\n      const idx = this.activeSymbols.lastIndexOf(frame.symbolIndex);\n      if (idx >= 0) this.activeSymbols.splice(idx, 1);\n    }\n  }\n\n  private handleSemicolon(): void {\n    const current = this.pos;\n    for (let i = this.pendingBodies.length - 1; i >= 0; i--) {\n      const pending = this.pendingBodies[i];\n      if (!pending.allowBodyless) continue;\n      if (pending.bodyOffset !== undefined && pending.bodyOffset <= current) continue;\n      this.pendingBodies.splice(i, 1);\n      break;\n    }\n  }\n\n  private matchKeywordAt(pos: number, keyword: string): boolean {\n    if (pos + keyword.length > this.length) return false;\n    const slice = this.masked.slice(pos, pos + keyword.length).toLowerCase();\n    if (slice !== keyword) return false;\n\n    const before = pos > 0 ? this.masked[pos - 1] : \"\";\n    const after = pos + keyword.length < this.length ? this.masked[pos + keyword.length] : \"\";\n    if ((before && isIdentifierPart(before)) || (after && isIdentifierPart(after))) {\n      return false;\n    }\n    return true;\n  }\n\n  private probeBodyOffset(info: DeclarationInfo, start: number): BodyExpectation {\n    let i = start;\n    let depthParen = 0;\n    let depthAngle = 0;\n    let depthBracket = 0;\n\n    while (i < this.length) {\n      const ch = this.masked[i];\n      if (ch === \"(\") {\n        depthParen++;\n        i++;\n        continue;\n      }\n      if (ch === \")\") {\n        if (depthParen > 0) depthParen--;\n        i++;\n        continue;\n      }\n      if (ch === \"<\") {\n        depthAngle++;\n        i++;\n        continue;\n      }\n      if (ch === \">\") {\n        if (depthAngle > 0) depthAngle--;\n        i++;\n        continue;\n      }\n      if (ch === \"[\") {\n        depthBracket++;\n        i++;\n        continue;\n      }\n      if (ch === \"]\") {\n        if (depthBracket > 0) depthBracket--;\n        i++;\n        continue;\n      }\n      if (isWhitespace(ch)) {\n        i++;\n        continue;\n      }\n      if (!depthParen && !depthAngle && !depthBracket) {\n        if (ch === \"{\") return { kind: \"body\", offset: i };\n        if (ch === \";\") {\n          return info.allowBodyless ? { kind: \"none\" } : { kind: \"unknown\" };\n        }\n        if (ch === \"=\") {\n          return { kind: \"none\" };\n        }\n      }\n      i++;\n    }\n\n    return { kind: \"unknown\" };\n  }\n}\n\nfunction extract(doc: TextDocument): IndexedSymbol[] {\n  const parser = new SymbolParser(doc);\n  const symbols = parser.parse();\n  return dedupe(symbols, (s) => `${s.kind}:${s.name}:${s.line}:${s.character}`);\n}\n\n/* ============================================================================\n * API d’index\n * ========================================================================== */\n\n/** Indexe un document (remplace l’entrée précédente). */\nexport function indexDocument(doc: TextDocument): void {\n  INDEX.set(doc.uri, extract(doc));\n}\n\n/** Indexe une chaîne pour un uri donné. */\nexport function indexText(uri: string, text: string): void {\n  const doc = TextDocument.create(uri, \"vitte\", 0, text);\n  INDEX.set(uri, extract(doc));\n}\n\n/** Réindexe un document (alias plus explicite). */\nexport function updateDocument(doc: TextDocument): void {\n  INDEX.set(doc.uri, extract(doc));\n}\n\n/** Supprime un document de l’index. */\nexport function removeDocument(uri: string): void {\n  INDEX.delete(uri);\n}\n\n/** Vide l’index. */\nexport function clearIndex(): void {\n  INDEX.clear();\n}\n\n/** Récupère l’index brut (lecture seule). */\nexport function getIndex(): ReadonlyMap<Uri, IndexedSymbol[]> {\n  return INDEX;\n}\n\n/** Récupère les symboles d’un document. */\nexport function getDocumentIndex(uri: string): IndexedSymbol[] {\n  return INDEX.get(uri) ?? [];\n}\n\n/* ============================================================================\n * Requêtes et conversions LSP\n * ========================================================================== */\n\n/** Recherche globale par fuzzy + préfixe, tri par score et nature. */\nexport function searchWorkspaceSymbols(query: string, limit = 400): IndexedSymbol[] {\n  const q = query.trim().toLowerCase();\n  const all = flattenIndex();\n  if (!q) return all.slice(0, limit);\n\n  const scored = all\n    .map((s) => ({ s, score: fuzzyScore(s.name.toLowerCase(), q) }))\n    .filter((x) => x.score > 0)\n    .sort((a, b) =>\n      b.score - a.score ||\n      rankKind(b.s.kind) - rankKind(a.s.kind) ||\n      a.s.name.localeCompare(b.s.name)\n    )\n    .slice(0, limit)\n    .map((x) => x.s);\n\n  return scored;\n}\n\n/** Conversion vers SymbolInformation[] (Workspace Symbols). */\nexport function toWorkspaceSymbols(syms: IndexedSymbol[]): LspSymbolInformation[] {\n  return syms.map((s) => ({\n    name: s.name,\n    kind: toLspKind(s.kind),\n    location: {\n      uri: s.uri,\n      range: lspRange(s.line, s.character, s.endLine ?? s.line, s.endCharacter ?? s.character),\n    } as LspLocation,\n    containerName: s.containerName,\n  }));\n}\n\n/** Conversion hiérarchique DocumentSymbol[] pour un document. */\nexport function toDocumentSymbols(doc: TextDocument): LspDocumentSymbol[] {\n  const list = getDocumentIndex(doc.uri);\n  // Simple regroupement par containerName. Les doublons de nom sont pris tels quels.\n  const byName = new Map<string, LspDocumentSymbol>();\n  const roots: LspDocumentSymbol[] = [];\n\n  for (const s of list) {\n    const ds: LspDocumentSymbol = {\n      name: s.name,\n      kind: toLspKind(s.kind),\n      range: lspRange(s.line, s.character, s.endLine ?? s.line, s.endCharacter ?? s.character),\n      selectionRange: lspRange(s.line, s.character, s.line, Math.max(s.character, s.character + s.name.length)),\n      children: [],\n    };\n    if (s.containerName && byName.has(s.containerName)) {\n      byName.get(s.containerName)!.children!.push(ds);\n    } else {\n      roots.push(ds);\n    }\n    byName.set(s.name, ds);\n  }\n  return roots;\n}\n\n/** Renvoie les symboles à une position. */\nexport function symbolsAtPosition(uri: string, pos: { line: number; character: number }): IndexedSymbol[] {\n  const list = getDocumentIndex(uri);\n  return list.filter((s) => inRange(pos, s));\n}\n\n/** Définition naïve: symbole portant le même nom, priorisant le même fichier. */\nexport function findDefinition(uri: string, name: string): IndexedSymbol | undefined {\n  const local = getDocumentIndex(uri).find((s) => s.name === name);\n  if (local) return local;\n  for (const [, list] of INDEX) {\n    const hit = list.find((s) => s.name === name);\n    if (hit) return hit;\n  }\n  return undefined;\n}\n\n/** Références naïves: symboles du même nom dans l’index. */\nexport function findReferences(_uri: string, name: string, limit = 500): IndexedSymbol[] {\n  const acc: IndexedSymbol[] = [];\n  for (const list of INDEX.values()) {\n    for (const s of list) {\n      if (s.name === name) {\n        acc.push(s);\n        if (acc.length >= limit) return acc;\n      }\n    }\n  }\n  return acc;\n}\n\n/* ============================================================================\n * Utilitaires internes\n * ========================================================================== */\n\nfunction inRange(pos: { line: number; character: number }, s: IndexedSymbol): boolean {\n  const startOk =\n    pos.line > s.line || (pos.line === s.line && pos.character >= s.character);\n  const endLine = s.endLine ?? s.line;\n  const endChar = s.endCharacter ?? s.character;\n  const endOk = pos.line < endLine || (pos.line === endLine && pos.character <= endChar);\n  return startOk && endOk;\n}\n\nfunction flattenIndex(): IndexedSymbol[] {\n  const acc: IndexedSymbol[] = [];\n  for (const list of INDEX.values()) acc.push(...list);\n  return acc;\n}\n\nfunction toLspKind(k: SK): LspSymbolKind {\n  // Les valeurs numériques de SK sont alignées avec LSP. Cast sûr.\n  return k as unknown as LspSymbolKind;\n}\n\nfunction lspRange(sl: number, sc: number, el: number, ec: number): LspRange {\n  return {\n    start: { line: sl, character: sc } as LspPosition,\n    end: { line: el, character: ec } as LspPosition,\n  };\n}\n\n/** Fuzzy score simple. Favorise le préfixe et les sous-séquences denses. */\nfunction fuzzyScore(candidate: string, query: string): number {\n  if (candidate === query) return 1000;\n  if (candidate.startsWith(query)) return 800 - Math.min(200, candidate.length - query.length);\n  let qi = 0;\n  let streak = 0;\n  let score = 0;\n  for (let i = 0; i < candidate.length && qi < query.length; i++) {\n    if (candidate[i] === query[qi]) {\n      qi++; streak++; score += 5 + Math.min(10, streak);\n    } else {\n      streak = 0;\n    }\n  }\n  return qi === query.length ? 300 + score : 0;\n}\n\n/** Ordre de priorité par nature de symbole. */\nfunction rankKind(k: SK): number {\n  switch (k) {\n    case SK.Namespace:\n    case SK.Module: return 6;\n    case SK.Class:\n    case SK.Struct:\n    case SK.Interface:\n    case SK.Enum:   return 5;\n    case SK.Function:\n    case SK.Method:\n    case SK.Constructor: return 4;\n    case SK.Property:\n    case SK.Field:  return 3;\n    case SK.Variable:\n    case SK.Constant: return 2;\n    default: return 1;\n  }\n}\n\n/** Déduplication générique. */\nfunction dedupe<T>(arr: T[], key: (t: T) => string): T[] {\n  const seen = new Set<string>();\n  const out: T[] = [];\n  for (const x of arr) {\n    const k = key(x);\n    if (seen.has(k)) continue;\n    seen.add(k);\n    out.push(x);\n  }\n  return out;\n}\n\nfunction maskNonCode(src: string): string {\n  const chars = Array.from(src);\n  const len = chars.length;\n  let i = 0;\n\n  const blank = (idx: number) => {\n    if (idx >= 0 && idx < len && chars[idx] !== \"\\n\") {\n      chars[idx] = \" \";\n    }\n  };\n\n  while (i < len) {\n    const ch = chars[i];\n\n    if (ch === \"/\" && i + 1 < len && chars[i + 1] === \"/\") {\n      blank(i);\n      blank(i + 1);\n      i += 2;\n      while (i < len && chars[i] !== \"\\n\") {\n        blank(i);\n        i++;\n      }\n      continue;\n    }\n\n    if (ch === \"/\" && i + 1 < len && chars[i + 1] === \"*\") {\n      blank(i);\n      blank(i + 1);\n      i += 2;\n      while (i + 1 < len && !(chars[i] === \"*\" && chars[i + 1] === \"/\")) {\n        if (chars[i] !== \"\\n\") chars[i] = \" \";\n        i++;\n      }\n      if (i < len) {\n        blank(i);\n        i++;\n      }\n      if (i < len) {\n        blank(i);\n        i++;\n      }\n      continue;\n    }\n\n    if (ch === \"'\" || ch === \"\\\"\") {\n      const quote = ch;\n      blank(i);\n      i++;\n      while (i < len) {\n        const current = chars[i];\n        if (current === \"\\n\") {\n          i++;\n          break;\n        }\n        blank(i);\n        if (current === quote && chars[i - 1] !== \"\\\\\") {\n          i++;\n          break;\n        }\n        i++;\n      }\n      continue;\n    }\n\n    if (ch === \"r\") {\n      let j = i + 1;\n      while (j < len && chars[j] === \"#\") j++;\n      if (j < len && chars[j] === \"\\\"\") {\n        const hashCount = j - (i + 1);\n        const terminator = \"\\\"\" + \"#\".repeat(hashCount);\n        blank(i);\n        for (let t = i + 1; t <= j; t++) blank(t);\n        let k = j + 1;\n        while (k < len) {\n          if (chars[k] === \"\\n\") {\n            k++;\n            continue;\n          }\n          if (src.startsWith(terminator, k)) {\n            for (let t = 0; t < terminator.length; t++) {\n              blank(k + t);\n            }\n            k += terminator.length;\n            break;\n          }\n          blank(k);\n          k++;\n        }\n        i = k;\n        continue;\n      }\n    }\n\n    i++;\n  }\n\n  return chars.join(\"\");\n}\n\nfunction isWhitespace(ch: string | undefined): boolean {\n  return ch === \" \" || ch === \"\\t\" || ch === \"\\r\" || ch === \"\\n\" || ch === \"\\f\";\n}\n\nfunction isIdentifierStart(ch: string | undefined): boolean {\n  if (!ch) return false;\n  return /[A-Za-z_]/.test(ch);\n}\n\nfunction isIdentifierPart(ch: string | undefined): boolean {\n  if (!ch) return false;\n  return /[A-Za-z0-9_]/.test(ch);\n}\n"]}