{"version":3,"file":"languageService.js","sourceRoot":"","sources":["../../src/languageService.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Vitte LSP — Language Service (complete minimal)\n * -----------------------------------------------\n * Diagnostics & completion without external parser, with configurable rules.\n * Pure TypeScript. API remains compatible with lsp.ts (doValidation, doComplete, doResolve).\n */\n\nimport {\n  CompletionItemKind,\n  DiagnosticSeverity,\n  InsertTextFormat,\n  MarkupKind,\n} from 'vscode-languageserver/node';\nimport type {\n  Diagnostic,\n  CompletionItem,\n  TextDocumentPositionParams,\n  MarkupContent,\n} from 'vscode-languageserver/node';\n\n// Lightweight TextDocument facade (subset used by TextDocuments())\nexport interface LspTextDocument {\n  uri: string;\n  getText(range?: { start: { line: number; character: number }; end: { line: number; character: number } }): string;\n}\n\n// ---------------------------------------------------------------------------\n// Settings (lint/heuristics)\n// ---------------------------------------------------------------------------\n\nexport interface VitteLintSettings {\n  maxLineLength: number;            // warn if a line exceeds this many chars (0 to disable)\n  warnTrailingWhitespace: boolean;  // highlight spaces/tabs at end of line\n  hintTodoFixme: boolean;           // show TODO/FIXME/XXX as Hint\n  warnMixedIndent: boolean;         // warn if both tabs and spaces are used for leading indent in file\n}\n\nconst DEFAULT_SETTINGS: VitteLintSettings = {\n  maxLineLength: 140,\n  warnTrailingWhitespace: true,\n  hintTodoFixme: true,\n  warnMixedIndent: true,\n};\n\n// Small helpers\nfunction hasTabsOnly(s: string): boolean { return /^\\t+$/.test(s); }\nfunction hasSpacesOnly(s: string): boolean { return /^ +$/.test(s); }\n\n// ---------------------------------------------------------------------------\n// Language Service\n// ---------------------------------------------------------------------------\n\nexport class VitteLanguageService {\n  private settings: VitteLintSettings;\n\n  constructor(opts: Partial<VitteLintSettings> = {}) {\n    this.settings = { ...DEFAULT_SETTINGS, ...opts };\n  }\n\n  /** Update settings at runtime without recreating the service. */\n  setSettings(partial: Partial<VitteLintSettings>) {\n    this.settings = { ...this.settings, ...partial };\n  }\n\n  /** Basic diagnostics: TODO/FIXME/XXX, long lines, trailing spaces, mixed indentation. */\n  doValidation(doc: LspTextDocument): Promise<Diagnostic[]> {\n    const cfg = this.settings;\n    const text = doc.getText();\n    const diagnostics: Diagnostic[] = [];\n\n    const lines = text.replace(/\\r\\n/g, '\\n').split('\\n');\n    let sawTabIndent = false;\n    let sawSpaceIndent = false;\n\n    for (let i = 0; i < lines.length; i++) {\n      const line = lines[i];\n\n      // Leading indentation sampling for mixed‑indent detection\n      const mIndent = /^(\\s*)/.exec(line);\n      if (mIndent) {\n        const lead = mIndent[1];\n        if (lead.length > 0) {\n          // Only consider pure tab or pure space runs at the beginning\n          if (hasTabsOnly(lead)) sawTabIndent = true; else if (hasSpacesOnly(lead)) sawSpaceIndent = true;\n        }\n      }\n\n      // TODO/FIXME/XXX as Hint\n      if (cfg.hintTodoFixme) {\n        const m = /(TODO|FIXME|XXX)(:?)(.*)/.exec(line);\n        if (m) {\n          diagnostics.push({\n            severity: DiagnosticSeverity.Hint,\n            message: `Note: ${m[1]}${m[2]}${m[3] ?? ''}`.trim(),\n            range: { start: { line: i, character: m.index }, end: { line: i, character: m.index + m[0].length } },\n            source: 'vitte-lsp',\n            code: 'vitte.todofixme',\n          });\n        }\n      }\n\n      // Long line\n      if (cfg.maxLineLength > 0 && line.length > cfg.maxLineLength) {\n        diagnostics.push({\n          severity: DiagnosticSeverity.Warning,\n          message: `Ligne trop longue (${line.length} > ${cfg.maxLineLength})`,\n          range: { start: { line: i, character: cfg.maxLineLength }, end: { line: i, character: line.length } },\n          source: 'vitte-lsp',\n          code: 'vitte.maxLineLength',\n        });\n      }\n\n      // Trailing whitespace\n      if (cfg.warnTrailingWhitespace) {\n        const tw = /(\\s+)$/.exec(line);\n        if (tw && tw[1].length > 0) {\n          const start = line.length - tw[1].length;\n          diagnostics.push({\n            severity: DiagnosticSeverity.Warning,\n            message: 'Espace en fin de ligne',\n            range: { start: { line: i, character: start }, end: { line: i, character: line.length } },\n            source: 'vitte-lsp',\n            code: 'vitte.trailingWhitespace',\n          });\n        }\n      }\n    }\n\n    // Mixed indentation (file scope)\n    if (cfg.warnMixedIndent && sawTabIndent && sawSpaceIndent) {\n      diagnostics.push({\n        severity: DiagnosticSeverity.Warning,\n        message: 'Indentation mixte détectée (tabs et espaces). Normalisez votre indentation.',\n        range: { start: { line: 0, character: 0 }, end: { line: Math.max(0, lines.length - 1), character: 0 } },\n        source: 'vitte-lsp',\n        code: 'vitte.mixedIndent',\n      });\n    }\n\n    return Promise.resolve(diagnostics);\n  }\n\n  /**\n   * Completions: keywords + simple snippets for declarations.\n   * We avoid context parsing; snippets are provided for productivity.\n   */\n  doComplete(_params: TextDocumentPositionParams): CompletionItem[] {\n    const items: CompletionItem[] = [\n      { label: 'module', kind: CompletionItemKind.Keyword, detail: 'Déclaration de module', insertTextFormat: InsertTextFormat.Snippet, insertText: 'module ${1:my.module};' },\n      { label: 'import', kind: CompletionItemKind.Keyword, detail: 'Import', insertTextFormat: InsertTextFormat.Snippet, insertText: 'import ${1:path::to::item};' },\n      { label: 'fn', kind: CompletionItemKind.Keyword, detail: 'Déclaration de fonction', insertTextFormat: InsertTextFormat.Snippet, insertText: 'fn ${1:name}(${2:args}) {\\n\\t$0\\n}' },\n      { label: 'struct', kind: CompletionItemKind.Keyword, detail: 'Déclaration de structure', insertTextFormat: InsertTextFormat.Snippet, insertText: 'struct ${1:Name} {\\n\\t$0\\n}' },\n      { label: 'enum', kind: CompletionItemKind.Keyword, detail: 'Déclaration d’énumération', insertTextFormat: InsertTextFormat.Snippet, insertText: 'enum ${1:Name} {\\n\\t${2:Variant}\\n}' },\n      { label: 'union', kind: CompletionItemKind.Keyword, detail: 'Déclaration d’union', insertTextFormat: InsertTextFormat.Snippet, insertText: 'union ${1:Name} {\\n\\t$0\\n}' },\n      { label: 'type', kind: CompletionItemKind.Keyword, detail: 'Alias de type', insertTextFormat: InsertTextFormat.Snippet, insertText: 'type ${1:Name} = ${2:Existing};' },\n      { label: 'let', kind: CompletionItemKind.Keyword, detail: 'Binding (variable)', insertTextFormat: InsertTextFormat.Snippet, insertText: 'let ${1:name} = ${2:value};' },\n      { label: 'const', kind: CompletionItemKind.Keyword, detail: 'Constante', insertTextFormat: InsertTextFormat.Snippet, insertText: 'const ${1:NAME} = ${2:value};' },\n      { label: 'static', kind: CompletionItemKind.Keyword, detail: 'Statique', insertTextFormat: InsertTextFormat.Snippet, insertText: 'static ${1:NAME}: ${2:Type} = ${3:value};' },\n      { label: 'return', kind: CompletionItemKind.Keyword, detail: 'Retour de fonction', insertTextFormat: InsertTextFormat.Snippet, insertText: 'return ${1:value};' },\n      { label: 'match', kind: CompletionItemKind.Keyword, detail: 'Expression de correspondance', insertTextFormat: InsertTextFormat.Snippet, insertText: 'match ${1:expr} {\\n\\t${2:pattern} => ${3:result},\\n}' },\n      { label: 'if', kind: CompletionItemKind.Keyword, detail: 'Condition', insertTextFormat: InsertTextFormat.Snippet, insertText: 'if ${1:cond} {\\n\\t$0\\n}' },\n      { label: 'else', kind: CompletionItemKind.Keyword, detail: 'Alternative', insertTextFormat: InsertTextFormat.Snippet, insertText: 'else {\\n\\t$0\\n}' },\n      { label: 'while', kind: CompletionItemKind.Keyword, detail: 'Boucle while', insertTextFormat: InsertTextFormat.Snippet, insertText: 'while ${1:cond} {\\n\\t$0\\n}' },\n      { label: 'for', kind: CompletionItemKind.Keyword, detail: 'Boucle for', insertTextFormat: InsertTextFormat.Snippet, insertText: 'for ${1:item} in ${2:iter} {\\n\\t$0\\n}' },\n      { label: 'loop', kind: CompletionItemKind.Keyword, detail: 'Boucle infinie', insertTextFormat: InsertTextFormat.Snippet, insertText: 'loop {\\n\\t$0\\n}' },\n    ];\n    return items;\n  }\n\n  /** Attach a bit more detail on resolve. */\n  doResolve(item: CompletionItem): CompletionItem {\n    const label = String(item.label);\n    const extra = this._docFor(label);\n    item.detail ??= extra.title;\n    const documentation: MarkupContent = { kind: MarkupKind.Markdown, value: extra.markdown };\n    item.documentation = documentation;\n    return item;\n  }\n\n  private _docFor(label: string): { title: string; markdown: string } {\n    switch (label) {\n      case 'module': return { title: 'Déclaration de module', markdown: '**module** — Déclare le module courant.\\n\\n```vitte\\nmodule my.module;\\n```' };\n      case 'import': return { title: 'Import', markdown: '**import** — Ajoute un symbole d’un autre module.\\n\\n```vitte\\nimport std::core;\\n```' };\n      case 'fn': return { title: 'Déclaration de fonction', markdown: '**fn** — Déclare une fonction.\\n\\n```vitte\\nfn name(args) {\\n    // corps\\n}\\n```' };\n      case 'struct': return { title: 'Déclaration de structure', markdown: '**struct** — Regroupe des champs.\\n\\n```vitte\\nstruct Name {\\n    field: Type\\n}\\n```' };\n      case 'enum': return { title: 'Déclaration d’énumération', markdown: '**enum** — Variantes nommées.\\n\\n```vitte\\nenum Name {\\n    Variant\\n}\\n```' };\n      case 'union': return { title: 'Déclaration d’union', markdown: '**union** — Représentation mémoire partagée.\\n\\n```vitte\\nunion Name {\\n    field: Type\\n}\\n```' };\n      case 'type': return { title: 'Alias de type', markdown: '**type** — Alias vers un autre type.\\n\\n```vitte\\ntype Alias = Existing;\\n```' };\n      case 'let': return { title: 'Binding', markdown: '**let** — Nouveau binding.\\n\\n```vitte\\nlet x = 1;\\n```' };\n      case 'const': return { title: 'Constante', markdown: '**const** — Valeur immuable.\\n\\n```vitte\\nconst NAME = 1;\\n```' };\n      case 'static': return { title: 'Statique', markdown: '**static** — Valeur globale statique.\\n\\n```vitte\\nstatic NAME: Type = init();\\n```' };\n      case 'match': return { title: 'Expression de correspondance', markdown: '**match** — Branches par motif.\\n\\n```vitte\\nmatch x {\\n    0 => 1,\\n}\\n```' };\n      default: return { title: String(label), markdown: `**${label}**` };\n    }\n  }\n}\n\nexport default VitteLanguageService;\n"]}