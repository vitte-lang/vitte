{"version":3,"file":"docstrings.js","sourceRoot":"","sources":["../../src/docstrings.ts"],"names":[],"mappings":"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","sourcesContent":["import type { TextDocument } from \"vscode-languageserver-textdocument\";\n\nfunction isAttributeLine(line: string): boolean {\n  return /^\\s*#\\s*\\[.*\\]\\s*$/.test(line);\n}\n\nfunction isLineDoc(line: string): { ok: boolean; text: string } {\n  const m = /^\\s*(?:\\/\\/\\/|##)\\s?(.*)$/.exec(line);\n  if (!m) return { ok: false, text: \"\" };\n  return { ok: true, text: m[1] ?? \"\" };\n}\n\nfunction extractBlockDoc(lines: string[], start: number, end: number): string {\n  const out: string[] = [];\n  for (let i = start; i <= end; i++) {\n    const raw = lines[i];\n    const line = raw\n      .replace(/^\\s*\\/\\*\\*?/, \"\")\n      .replace(/\\*\\/\\s*$/, \"\")\n      .replace(/^\\s*\\*\\s?/, \"\");\n    out.push(line);\n  }\n  return out.join(\"\\n\").trim();\n}\n\nexport function getDocstringAtLine(doc: TextDocument, declLine: number): string | null {\n  const lines = doc.getText().split(/\\r?\\n/);\n  let i = Math.min(declLine - 1, lines.length - 1);\n  const collected: string[] = [];\n  let seenDoc = false;\n\n  while (i >= 0) {\n    const line = lines[i];\n    if (/^\\s*$/.test(line)) {\n      return seenDoc ? collected.reverse().join(\"\\n\").trim() || null : null;\n    }\n    if (isAttributeLine(line)) {\n      i--;\n      continue;\n    }\n    const ld = isLineDoc(line);\n    if (ld.ok) {\n      seenDoc = true;\n      collected.push(ld.text);\n      i--;\n      continue;\n    }\n    if (line.includes(\"*/\")) {\n      let j = i;\n      while (j >= 0 && !lines[j].includes(\"/**\")) j--;\n      if (j >= 0) {\n        const block = extractBlockDoc(lines, j, i);\n        return block || null;\n      }\n    }\n    break;\n  }\n\n  if (seenDoc) {\n    const text = collected.reverse().join(\"\\n\").trim();\n    return text || null;\n  }\n  return null;\n}\n"]}