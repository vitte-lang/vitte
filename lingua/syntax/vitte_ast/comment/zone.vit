# =========================================================
# Vitte 1.0 — AST / Comment / Zone
# =========================================================

space vitte/ast/comment/zone

share all

<<< doc
Ce module définit la représentation AST des commentaires
de zone Vitte.

Syntaxe source :
    <<< tag?
        contenu libre (multiligne)
    >>>

Les commentaires de zone :
- n’influencent pas la sémantique
- peuvent contenir de la documentation, des notes ou des métadonnées
- sont conservables pour :
    - diagnostics
    - documentation
    - outils (LSP, docgen)
    - pretty-printer

Aucune interprétation du contenu n’est faite à ce niveau.
>>>

# ---------------------------------------------------------
# Position source (diagnostics précis)
# ---------------------------------------------------------

form Span
    field file as string
    field line_start as u32
    field line_end as u32
    field column_start as u32
    field column_end as u32
.end

# ---------------------------------------------------------
# Texte brut
# ---------------------------------------------------------

form RawText
    field value as string
.end

# ---------------------------------------------------------
# Tag optionnel de zone (<<< tag >>>)
# ---------------------------------------------------------

form ZoneTag
    field name as string
.end

# ---------------------------------------------------------
# Commentaire de zone
# ---------------------------------------------------------

form ZoneComment
    field tag as Option[ZoneTag]
    field body as RawText
    field span as Span
.end

# ---------------------------------------------------------
# Collection de commentaires de zone
# ---------------------------------------------------------

form ZoneCommentList
    field items as List[ZoneComment]
.end

# ---------------------------------------------------------
# Position logique du commentaire
# ---------------------------------------------------------

pick CommentPosition
    case Leading      # avant un nœud
    case Trailing     # après un nœud
    case Standalone   # bloc isolé
.end

# ---------------------------------------------------------
# Commentaire de zone annoté (attachable à l’AST)
# ---------------------------------------------------------

form AnnotatedZoneComment
    field comment as ZoneComment
    field position as CommentPosition
.end

# ---------------------------------------------------------
# Groupe de commentaires de zone attachés
# ---------------------------------------------------------

form ZoneCommentGroup
    field leading as List[ZoneComment]
    field trailing as List[ZoneComment]
.end