# =========================================================
# Vitte 1.0 — AST / Comment / Line
# =========================================================

space vitte/ast/comment/line

share all

<<< doc
Ce module définit la représentation AST des commentaires
de ligne Vitte.

Syntaxe source :
    # commentaire jusqu’à la fin de ligne

Les commentaires :
- n’ont aucun impact sémantique
- peuvent être conservés pour :
    - diagnostics
    - formatage
    - pretty-printer
    - outils (LSP, doc, lint)

Ils sont optionnellement attachables à des nœuds AST.
>>>

# ---------------------------------------------------------
# Position source (diagnostics précis)
# ---------------------------------------------------------

form Span
    field file as string
    field line_start as u32
    field line_end as u32
    field column_start as u32
    field column_end as u32
.end

# ---------------------------------------------------------
# Texte source brut
# ---------------------------------------------------------

form RawText
    field value as string
.end

# ---------------------------------------------------------
# Commentaire de ligne
# ---------------------------------------------------------

form LineComment
    field text as RawText
    field span as Span
.end

# ---------------------------------------------------------
# Collection de commentaires de ligne
# ---------------------------------------------------------

form LineCommentList
    field items as List[LineComment]
.end

# ---------------------------------------------------------
# Position logique du commentaire
# ---------------------------------------------------------

pick CommentPosition
    case Leading      # avant un nœud
    case Trailing     # après un nœud sur la même ligne
    case Standalone   # ligne seule
.end

# ---------------------------------------------------------
# Commentaire annoté (attachable à l’AST)
# ---------------------------------------------------------

form AnnotatedLineComment
    field comment as LineComment
    field position as CommentPosition
.end

# ---------------------------------------------------------
# Groupe de commentaires attachés
# ---------------------------------------------------------

form CommentGroup
    field leading as List[LineComment]
    field trailing as List[LineComment]
.end