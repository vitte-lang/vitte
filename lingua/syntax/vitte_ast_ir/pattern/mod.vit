// vitte_ast_ir skeleton

# ============================================================
# vitte â€” pattern/mod.vit
# AST-IR Pattern Aggregator â€” ULTRA MAX
# ============================================================

space vitte/ast_ir/pattern

# ----------------------------
# Submodules
# ----------------------------

pull vitte/ast_ir/pattern/ir_pattern
pull vitte/ast_ir/pattern/ir_match

# ----------------------------
# Public API
# ----------------------------

share all

# ----------------------------
# Pattern bundle
# ----------------------------

type PatternBundle
    patterns    : List[Pattern]
.end

# ----------------------------
# Constructors
# ----------------------------

proc PatternBundle.new() -> PatternBundle
    return PatternBundle {
        patterns = List.new()
    }
.end

# ----------------------------
# Management helpers
# ----------------------------

proc push(b: PatternBundle, p: Pattern)
    b.patterns.push(p)
.end

proc all_bindings(b: PatternBundle) -> Set[String]
    let out = Set.new()
    for p in b.patterns
        out = out.union(ir_pattern.bindings(p))
    .end
    return out
.end

proc has_irrefutable(b: PatternBundle) -> bool
    for p in b.patterns
        if ir_pattern.is_irrefutable(p)
            return true
        .end
    .end
    return false
.end

# ----------------------------
# Validation
# ----------------------------

proc validate(b: PatternBundle, ctx: DiagnosticCtx)
    for p in b.patterns
        ir_pattern.validate(p, ctx)
    .end
.end

# ----------------------------
# Debug / Dump
# ----------------------------

proc dump(b: PatternBundle)
    say "=== PatternBundle ==="
    for p in b.patterns
        ir_pattern.dump(p)
    .end
.end

# ----------------------------
# End of module
# ----------------------------