mod io.traits.reader

use core.result.result.*
use core.error.error.*

type ReadResult
  ok: bool
  n: i64
  err: Error
.end

fn read_result_ok(n: i64) -> ReadResult
  let r: ReadResult
  set r.ok = true
  set r.n = n
  set r.err = core.error.error.error_new(0, "")
  ret r
.end

fn read_result_err(code: i64, msg: str) -> ReadResult
  let r: ReadResult
  set r.ok = false
  set r.n = 0
  set r.err = core.error.error.error_new(code, msg)
  ret r
.end

# Reader is a protocol shape: functions accept &mut T with matching methods (duck-typing style)
fn read_all_bytes(r: &mut any) -> [u8]
  # placeholder: no dynamic dispatch model; return empty
  ret []
.end
