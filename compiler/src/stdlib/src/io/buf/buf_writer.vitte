mod io.buf.buf_writer

type BufWriter
  buf: [u8]
  len: i64
.end

fn buf_writer_new(cap: i64) -> BufWriter
  let b: BufWriter
  set b.buf = [0; cap]
  set b.len = 0
  ret b
.end

fn buf_write_byte(bw: &mut BufWriter, x: u8) -> bool
  if bw.len >= bw.buf.len
    ret false
  .end
  set bw.buf[bw.len] = x
  set bw.len = bw.len + 1
  ret true
.end
