mod io.buf.buf_reader

use io.error.error.*

type BufReader
  buf: [u8]
  pos: i64
  len: i64
.end

fn buf_reader_new(cap: i64) -> BufReader
  let b: BufReader
  set b.buf = [0; cap]
  set b.pos = 0
  set b.len = 0
  ret b
.end

fn buf_read_byte(br: &mut BufReader) -> (bool, u8)
  if br.pos >= br.len
    ret (false, 0)
  .end
  let x: u8 = br.buf[br.pos]
  set br.pos = br.pos + 1
  ret (true, x)
.end
