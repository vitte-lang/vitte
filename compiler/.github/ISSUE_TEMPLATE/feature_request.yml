name: "Feature request"
description: "Request a new feature or improvement for Vitte (compiler, runtime, stdlib, Muffin, tools)"
title: "[Feature]: "
labels:
  - enhancement
  - needs-triage
body:
  - type: markdown
    attributes:
      value: |
        Use this form to propose a feature, improvement, or ergonomic change.

        Before submitting:
        - Search existing issues (including closed).
        - Prefer a clear problem statement and concrete acceptance criteria.

        ---

        **Security note**: do **not** file public feature requests for security-sensitive changes. Use the security contact process.

  - type: checkboxes
    id: preflight
    attributes:
      label: "Pre-flight checks"
      description: "Confirm the following before we triage."
      options:
        - label: "I searched existing issues and did not find a duplicate."
          required: true
        - label: "This request is within the scope of Vitte (compiler/runtime/stdlib/Muffin/tools)."
          required: true
        - label: "I provided a clear problem statement and expected outcome."
          required: true

  - type: dropdown
    id: component
    attributes:
      label: "Component"
      description: "Where should this change live?"
      options:
        - "language: syntax / grammar"
        - "language: semantics / type system"
        - "compiler: lexer"
        - "compiler: parser (core)"
        - "compiler: parser (phrase/desugar)"
        - "compiler: AST"
        - "compiler: sema/typecheck"
        - "compiler: lower/IR"
        - "compiler: codegen"
        - "compiler: diagnostics"
        - "compiler: CLI (vittec)"
        - "muffin (manifest/resolver/build)"
        - "runtime: VM/bytecode"
        - "runtime: GC/alloc"
        - "runtime: FFI/ABI"
        - "stdlib"
        - "bench"
        - "lsp / tooling"
        - "docs/spec"
        - "other"
    validations:
      required: true

  - type: dropdown
    id: request_type
    attributes:
      label: "Request type"
      options:
        - "new feature"
        - "improvement / ergonomics"
        - "performance"
        - "better diagnostics"
        - "build / packaging"
        - "compatibility / platforms"
        - "documentation"
        - "other"
    validations:
      required: true

  - type: dropdown
    id: priority
    attributes:
      label: "Priority (your view)"
      description: "How important is this for you?"
      options:
        - "nice-to-have"
        - "important"
        - "blocking adoption"
        - "critical"
    validations:
      required: true

  - type: textarea
    id: problem
    attributes:
      label: "Problem statement"
      description: "What problem are you trying to solve? Include context and constraints."
      placeholder: |
        Today, when I try to ...
        I need ...
        Current behavior forces me to ...
    validations:
      required: true

  - type: textarea
    id: proposal
    attributes:
      label: "Proposed solution"
      description: "Describe the change you want. Be specific about surface syntax/API/flags."
      placeholder: |
        - New syntax / keyword / flag:
        - New API/module:
        - New behavior:
    validations:
      required: true

  - type: textarea
    id: acceptance
    attributes:
      label: "Acceptance criteria"
      description: "Define what ‘done’ means. Prefer bullet points that can become tests."
      placeholder: |
        - [ ] ...
        - [ ] ...
    validations:
      required: true

  - type: textarea
    id: examples
    attributes:
      label: "Examples"
      description: "Show example code / CLI usage before/after."
      placeholder: |
        **Before**
        ```vitte
        prog demo
          say "..."
          ret
        .end
        ```

        **After**
        ```vitte
        prog demo
          say "..."
          ret
        .end
        ```
    validations:
      required: false

  - type: textarea
    id: alternatives
    attributes:
      label: "Alternatives considered"
      description: "What other approaches did you consider and why not?"
      placeholder: |
        - Alternative A: ...
        - Alternative B: ...
    validations:
      required: false

  - type: textarea
    id: impact
    attributes:
      label: "Impact"
      description: "Who benefits and how? Include rough scale/frequency if possible."
      placeholder: |
        - Affects: (users, contributors, CI, runtime)
        - Frequency: (daily/weekly/rare)
        - Expected benefit: (time saved, fewer errors, etc.)
    validations:
      required: true

  - type: dropdown
    id: breaking
    attributes:
      label: "Breaking change?"
      description: "Will this break existing code or behavior?"
      options:
        - "unknown"
        - "no"
        - "yes (source)"
        - "yes (ABI)"
        - "yes (behavioral)"
    validations:
      required: true

  - type: textarea
    id: migration
    attributes:
      label: "Migration / compatibility plan (if breaking)"
      description: "Describe upgrade path, deprecation plan, flags, auto-fix, etc."
      placeholder: |
        - Deprecate in vX.Y
        - Provide compatibility flag ...
        - Provide formatter/lint fix ...
    validations:
      required: false

  - type: dropdown
    id: platforms
    attributes:
      label: "Platforms / environments"
      description: "Is this platform-specific?"
      options:
        - "all platforms"
        - "Linux"
        - "macOS"
        - "Windows"
        - "FreeBSD"
        - "NetBSD"
        - "OpenBSD"
        - "DragonFly BSD"
        - "Solaris / illumos"
        - "Other (describe below)"
    validations:
      required: true

  - type: textarea
    id: env_details
    attributes:
      label: "Environment details (if relevant)"
      description: "Host/target triples, toolchain versions, constraints."
      placeholder: |
        - Host OS:
        - Host arch:
        - Target triple:
        - Toolchain:
    validations:
      required: false

  - type: textarea
    id: scope
    attributes:
      label: "Scope / design notes"
      description: "What parts of the codebase/spec are likely affected? Any constraints?"
      placeholder: |
        - Parser/grammar:
        - Sema/type rules:
        - IR/lowering:
        - Runtime/VM:
        - Stdlib modules:
        - Muffin format:
    validations:
      required: false

  - type: textarea
    id: perf
    attributes:
      label: "Performance considerations"
      description: "Any perf target, expected regression risk, bench plan?"
      placeholder: |
        - Expected to improve ... by ...
        - Potential regressions:
        - Bench/suite to use:
    validations:
      required: false

  - type: textarea
    id: test_plan
    attributes:
      label: "Test plan"
      description: "What tests should be added/updated? Unit/integration/bench/fuzz."
      placeholder: |
        - Unit tests:
        - Integration tests:
        - Bench:
        - Fuzz:
    validations:
      required: false

  - type: textarea
    id: docs
    attributes:
      label: "Documentation updates"
      description: "What docs/spec files need changes?"
      placeholder: |
        - spec/vitte/...
        - README updates
        - examples
    validations:
      required: false

  - type: textarea
    id: prior_art
    attributes:
      label: "Prior art / references"
      description: "Links to similar features in other languages/compilers, papers, issues, etc."
      placeholder: |
        - Rust: ...
        - Zig: ...
        - LLVM: ...
        - Link: ...
    validations:
      required: false

  - type: checkboxes
    id: contribution
    attributes:
      label: "Contribution"
      description: "Optional, but helps planning."
      options:
        - label: "I would be willing to implement this (or part of it) with guidance."
          required: false
        - label: "I can provide a PR with tests."
          required: false
        - label: "I can help review/benchmark/bisect."
          required: false

  - type: textarea
    id: extra
    attributes:
      label: "Additional context"
      description: "Anything else? Screenshots, logs, edge-cases, constraints."
      placeholder: "Add any other relevant information here."
    validations:
      required: false

  - type: checkboxes
    id: coc
    attributes:
      label: "Code of Conduct"
      options:
        - label: "I agree to follow this project's Code of Conduct."
          required: true
