

# vitte_abi/src/lib.vit
#
# Package root for `vitte_abi`.
#
# Style
# - No `{}` blocks: only `.end`.
# - This file plays the role of a crate root: it wires submodules and re-exports.

mod vitte_abi

# -----------------------------------------------------------------------------
# Package metadata
# -----------------------------------------------------------------------------

# NOTE: Keep this aligned with your release tagging.
const VITTE_ABI_VERSION: str = "0.1.0"

fn vitte_abi_version() -> str
    ret VITTE_ABI_VERSION
.end

# -----------------------------------------------------------------------------
# Submodules
# -----------------------------------------------------------------------------

use vitte_abi.callconv
use vitte_abi.canon_abi
use vitte_abi.extern_abi
use vitte_abi.layout
use vitte_abi.tests

# -----------------------------------------------------------------------------
# Re-exports (public surface)
# -----------------------------------------------------------------------------

export all from vitte_abi.callconv
export all from vitte_abi.canon_abi
export all from vitte_abi.extern_abi
export all from vitte_abi.layout
export all from vitte_abi.tests

# -----------------------------------------------------------------------------
# Optional: pure smoke entry for unit harnesses
# -----------------------------------------------------------------------------

fn vitte_abi_smoke_all() -> bool
    # Pure smoke – no I/O.
    # Scope: quick invariants that should always hold.

    let ok: bool = true

    # extern_abi smoke (pure)
    if ok
        ok = vitte_abi.extern_abi.extern_abi_smoke_all()
    .end

    # layout smoke (pure)
    if ok
        ok = vitte_abi.layout.layout_smoke_all()
    .end

    ret ok
.end

fn vitte_abi_tests_all() -> bool
    # Full test suite – still pure (no I/O).
    # Useful for CI/unit runners that want a single entry.

    ret vitte_abi.tests.tests_all()
.end