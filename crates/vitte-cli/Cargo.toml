[package]
name        = "vitte-cli"
description = "Interface en ligne de commande du langage Vitte."

version      = { workspace = true }
edition      = { workspace = true }
rust-version = { workspace = true }
license      = { workspace = true }
repository   = { workspace = true }
homepage     = { workspace = true }
readme       = { workspace = true }

keywords   = ["vitte", "cli", "compiler", "tooling"]
categories = ["command-line-utilities", "development-tools"]

default-run = "vitte"

[lib]
name = "vitte_cli"
path = "src/lib.rs"

[[bin]]
name = "vitte"
path = "src/main.rs"

[features]
default = ["trace", "color", "modules", "engine", "fmt", "server"]
trace   = ["dep:log", "dep:env_logger"]
color   = ["dep:owo-colors"]
vm      = ["dep:vitte-vm"]
engine  = ["dep:vitte-compiler", "vm"]
modules = ["dep:vitte-modules", "dep:serde_json"]
fmt     = ["dep:vitte-fmt"]
server  = ["dep:tokio"]
analyzer-incremental = ["vitte-analyzer/incremental"]

[dependencies]
anyhow      = { workspace = true }
clap        = { workspace = true }
log         = { workspace = true, optional = true }
env_logger  = { workspace = true, optional = true }
owo-colors  = { workspace = true, optional = true }
serde_json  = { workspace = true, optional = true }
serde       = { workspace = true }
rustyline   = { workspace = true }
similar     = { version = "2" }
tempfile    = { workspace = true }
zstd        = { workspace = true }
dirs-next   = { workspace = true }
toml        = { workspace = true }
tokio       = { workspace = true, optional = true, features = ["net", "io-util", "rt-multi-thread", "macros", "sync", "fs"] }
semver      = { workspace = true }
vitte-core  = { path = "../vitte-core", version = "0.1.0" }
vitte-lexer = { path = "../vitte-lexer", version = "0.1.0" }
vitte-parser = { path = "../vitte-parser", version = "0.1.0" }
vitte-ast    = { path = "../vitte-ast", version = "0.1.0" }
vitte-analyzer = { path = "../vitte-analyzer", version = "0.1.0" }
blake3      = "1"
vitte-modules = { path = "../../modules/vitte-modules", version = "0.1.0", optional = true }
vitte-vm = { path = "../vitte-vm", version = "0.1.0", optional = true }
vitte-fmt = { path = "../vitte-fmt", version = "0.1.0", optional = true }
vitte-compiler = { path = "../vitte-compiler", version = "0.1.0", optional = true }

[dev-dependencies]
pretty_assertions = { workspace = true }
assert_cmd = "2"
predicates = "3"
insta = { version = "1", features = ["yaml"] }
tempfile = "3"
