<<<
assert.vit
std test assertions
>>>

space std/test/assert


<<<
imports
>>>

use std/core/types.bool
use std/core/types.string
use std/core/types.Unit

use std/core/panic
use std/core/cmp


<<<
core assertions
>>>

#[inline]
proc assert(cond: bool) {
    if not cond {
        panic.panic("assertion failed")
    }
}

#[inline]
proc assert_msg(cond: bool, msg: string) {
    if not cond {
        panic.panic(msg)
    }
}


<<<
boolean assertions
>>>

#[inline]
proc assert_true(v: bool) {
    if not v {
        panic.panic("assert_true failed")
    }
}

#[inline]
proc assert_false(v: bool) {
    if v {
        panic.panic("assert_false failed")
    }
}


<<<
equality assertions
>>>

#[inline]
proc assert_eq[T](a: T, b: T) {
    if not cmp.eq(a, b) {
        panic.panic("assert_eq failed")
    }
}

#[inline]
proc assert_ne[T](a: T, b: T) {
    if cmp.eq(a, b) {
        panic.panic("assert_ne failed")
    }
}


<<<
ordering assertions
>>>

#[inline]
proc assert_lt[T](a: T, b: T) {
    if not cmp.lt(a, b) {
        panic.panic("assert_lt failed")
    }
}

#[inline]
proc assert_le[T](a: T, b: T) {
    if not cmp.le(a, b) {
        panic.panic("assert_le failed")
    }
}

#[inline]
proc assert_gt[T](a: T, b: T) {
    if not cmp.gt(a, b) {
        panic.panic("assert_gt failed")
    }
}

#[inline]
proc assert_ge[T](a: T, b: T) {
    if not cmp.ge(a, b) {
        panic.panic("assert_ge failed")
    }
}


<<<
optional helpers
>>>

#[inline]
proc unreachable() -> Unit {
    panic.panic("unreachable reached")
}